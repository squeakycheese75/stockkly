define(["idcta-v2/mvt","idcta-v2/id-config","idcta-v2/es6-promise"],function(l,c,i){var e={},r="ckns_usip",a=12096e5,s=864e5,u=18e5,d={A:{variantName:"control",buttonColour:"blue"},B:{variantName:"brand-family",buttonColour:"white"},C:{variantName:"with-you",buttonColour:"blue"}};function m(e){var t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()}function p(){window.usiOverlay.style.display="none",l.sendEvent("prompt_dismiss_click"),document.dispatchEvent(new CustomEvent("bbc-user-event",{detail:{container:"id-cta",label:"id-cta-dismiss-usi",type:"click",metadata:{"id-cta-type":"usi-prompt"},source:"responsive_web"}}))}function v(t,n,i){t.addEventListener("keydown",function(e){if(e.target===t&&9===e.keyCode&&(void 0===n||e.shiftKey===n))return e.preventDefault(),i(e)})}function f(e){var t,n,i=window.scrollX,o=window.scrollY;e.focus({preventScroll:!0}),t=i,n=o,window.scrollTo(t,n)}function w(e){var t,n,i,o,a;(t=document.getElementById("edr_survey"))&&(t.style.display="none"),n=e.css,(i=document.createElement("link")).type="text/css",i.rel="stylesheet",i.href=n,document.head.appendChild(i),o=e.html,(a=document.createElement("div")).className="usi-overlay",a.id="usiOverlay",a.innerHTML=o,document.body.appendChild(a);var c,r,s=document.getElementById("usiModalSignIn"),u=document.getElementById("usiModalRegister"),d=document.getElementById("usiModalClose");r=d,v(c=s,!0,function(){r.focus()}),v(r,!1,function(){c.focus()}),s.addEventListener("click",function(){l.sendEvent("prompt_sign_in_click")}),u.addEventListener("click",function(){l.sendEvent("prompt_register_click")}),d.addEventListener("click",p),document.getElementById("usiOverlay").addEventListener("click",function(e){document.getElementById("usiModal").contains(e.target)||p()}),window.usiOverlay.style.display="block",window.usiOverlay.style.zIndex=1050,f(s)}function y(e){var t=Date.now(),n=new Date(t+a),i=Math.round(a/1e3),o=encodeURIComponent("counter-"+e+"-lastView-"+t);document.cookie=r+"="+o+"; path=/; expires="+n+"; max-age="+i,document.dispatchEvent(new CustomEvent("usiCookieChanged"))}function h(e,t){return Date.now()-t<e}function o(e,t,n){var i,o;if(m(r)){var a=(o=m(r).split("-"),{counter:parseInt(o[1]),lastView:parseInt(o[3])});if("index"===e)switch(a.counter){case 0:h(a.lastView,s)||y(1);break;case 1:y(1);break;default:h(a.lastView,u)?y(a.counter):y(1)}if("article"===e)switch(a.counter){case 0:break;case 1:case 2:h(a.lastView,u)&&(a.counter++,y(a.counter));break;default:if(h(a.lastView,u))if(y(0),i=t,l.sendAttributes({seen_prompt:!0,product:i}),l.sendEvent("prompt_viewed"),!("A"===n))return function(i,o){if(window.fetch)return c.getConfigAsync().then(function(e){var t=e.ptrt,n=window.idctaBaseUrl+"/idcta/modal?variant="+d[i].variantName+"&buttonColour="+d[i].buttonColour+"&ptrt="+t+"&context="+o;return fetch(n).then(function(e){return e.json()}).then(function(e){w(e),document.dispatchEvent(new CustomEvent("bbc-user-event",{detail:{container:"id-cta",label:"id-cta-prompt-usi",metadata:{"id-cta-type":"usi-prompt"},source:"responsive_web"}}))})})}(n,t)}}else"index"===e&&(l.sendAttributes({seen_prompt:!1}),y(1))}return e.initialise=function(e,t,n){if(n)return i.resolve().then(function(){return o(t,e,n)})},e.hasInitialised=function(){return Boolean(m(r))},e});
//# sourceMappingURL=signInPrompt.js.map
