!function(){"use strict";function a(a,b){if(a){if(d(a))return void a.classList.add(b);if(null!==a.className)return void(a.className+=" "+b);a.className=b}}function b(a,b){if(a)if(d(a))a.classList.remove(b);else{var c="(^|\\b)"+b.split(" ").join("|")+"(\\b|$)",e=new RegExp(c,"gi");a.className=a.className.replace(e," ")}}function c(a,b){return!!a&&(d(a)?a.classList.contains(b):new RegExp("\\b"+b+"\\b").test(a.className))}function d(a){return void 0!==a.classList}function e(a,b,c){var d=a.details;if(d.length>1)for(var e=f(),g=0;g<d.length;g+=1){var h=document.createElement("li");h.className="ls-c-locations-list-item",h.innerHTML='<a class="ls-o-location ls-o-location--dark" data-id="'+g+'"><span class="gel-long-primer">'+d[g].data.name+"</span></a>",e.appendChild(h),function(a,b,d,e){b.addEventListener("click",function(){c(a,d[e])})}(b,h,d,g)}else c(b,d[0])}function f(){var c=document.querySelector(".js-local-news"),d=c.querySelector(".ls-c-news__message-container");b(d,"gs-u-display-none"),a(d,"ls-c-locations-list"),c.querySelector(".ls-c-message__container").innerHTML='<p class="gel-long-primer ls-c-message__content ls-c-message__content--active">Your chosen location falls between two News Regions. To set your location, please select one of the regions below.</p>';var e=document.createElement("ul");return e.className="ls-c-locations-list-list",d.appendChild(e),e}function g(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function h(){var a=k.NAMESPACE;window.require.config({paths:{"relay-1":"//static.bbci.co.uk/frameworks/relay/0.2.6/sharedmodules/relay-1",uasclient:"//static.bbci.co.uk/uasclient/0.1.42/modules/uasclient","news-location-search":"//m.files.bbci.co.uk/modules/bbc-morph-news-location-search/6.0.3/main","istats-1":"//nav.files.bbci.co.uk/nav-analytics/0.1.0-62/js/istats-1"}}),window.require(["news-location-search","istats-1"],function(b,c){var d=new b.Api(v),e=new w(b.NewsController,b.En,c),f=new z(d,b.Geolocation,new b.PreferredLocation(d),new b.News),g=new q(a,e,f,b.Events),h=new r(b.Events,c);g.init(),h.eventListeners()})}var i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},j=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a,b){!function(c,d){"object"==typeof b&&void 0!==a?a.exports=d():"function"==typeof define&&define.amd?define(d):c.ES6Promise=d()}(i,function(){function a(a){var b=typeof a;return null!==a&&("object"===b||"function"===b)}function b(a){return"function"==typeof a}function c(a){N=a}function d(a){O=a}function e(){return void 0!==M?function(){M(h)}:f()}function f(){var a=setTimeout;return function(){return a(h,1)}}function h(){for(var a=0;a<L;a+=2){(0,U[a])(U[a+1]),U[a]=void 0,U[a+1]=void 0}L=0}function j(a,b){var c=this,d=new this.constructor(l);void 0===d[W]&&B(d);var e=c._state;if(e){var f=arguments[e-1];O(function(){return y(e,d,f,c._result)})}else w(c,d,a,b);return d}function k(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(l);return s(c,a),c}function l(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function n(){return new TypeError("A promises callback cannot return that same promise.")}function o(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}function p(a,b,c){O(function(a){var d=!1,e=o(c,b,function(c){d||(d=!0,b!==c?s(a,c):u(a,c))},function(b){d||(d=!0,v(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,v(a,e))},a)}function q(a,b){b._state===Y?u(a,b._result):b._state===Z?v(a,b._result):w(b,void 0,function(b){return s(a,b)},function(b){return v(a,b)})}function r(a,c,d){c.constructor===a.constructor&&d===j&&c.constructor.resolve===k?q(a,c):void 0===d?u(a,c):b(d)?p(a,c,d):u(a,c)}function s(b,c){if(b===c)v(b,m());else if(a(c)){var d=void 0;try{d=c.then}catch(a){return void v(b,a)}r(b,c,d)}else u(b,c)}function t(a){a._onerror&&a._onerror(a._result),x(a)}function u(a,b){a._state===X&&(a._result=b,a._state=Y,0!==a._subscribers.length&&O(x,a))}function v(a,b){a._state===X&&(a._state=Z,a._result=b,O(t,a))}function w(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+Y]=c,e[f+Z]=d,0===f&&a._state&&O(x,a)}function x(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d=void 0,e=void 0,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?y(c,d,e,f):e(f);a._subscribers.length=0}}function y(a,c,d,e){var f=b(d),g=void 0,h=void 0,i=!0;if(f){try{g=d(e)}catch(a){i=!1,h=a}if(c===g)return void v(c,n())}else g=e;c._state!==X||(f&&i?s(c,g):!1===i?v(c,h):a===Y?u(c,g):a===Z&&v(c,g))}function z(a,b){try{b(function(b){s(a,b)},function(b){v(a,b)})}catch(b){v(a,b)}}function A(){return $++}function B(a){a[W]=$++,a._state=void 0,a._result=void 0,a._subscribers=[]}function C(){return new Error("Array Methods must be provided an Array")}function D(a){return new _(this,a).promise}function E(a){var b=this;return new b(K(a)?function(c,d){for(var e=a.length,f=0;f<e;f++)b.resolve(a[f]).then(c,d)}:function(a,b){return b(new TypeError("You must pass an array to race."))})}function F(a){var b=this,c=new b(l);return v(c,a),c}function G(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function I(){var a=void 0;if(void 0!==i)a=i;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(a){throw new Error("polyfill failed because global object is unavailable in this environment")}var b=a.Promise;if(b){var c=null;try{c=Object.prototype.toString.call(b.resolve())}catch(a){}if("[object Promise]"===c&&!b.cast)return}a.Promise=aa}var J=void 0;J=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var K=J,L=0,M=void 0,N=void 0,O=function(a,b){U[L]=a,U[L+1]=b,2===(L+=2)&&(N?N(h):V())},P="undefined"!=typeof window?window:void 0,Q=P||{},R=Q.MutationObserver||Q.WebKitMutationObserver,S="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),T="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,U=new Array(1e3),V=void 0;V=S?function(){return function(){return process.nextTick(h)}}():R?function(){var a=0,b=new R(h),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}():T?function(){var a=new MessageChannel;return a.port1.onmessage=h,function(){return a.port2.postMessage(0)}}():void 0===P&&"function"==typeof g?function(){try{var a=Function("return this")().require("vertx");return M=a.runOnLoop||a.runOnContext,e()}catch(a){return f()}}():f();var W=Math.random().toString(36).substring(2),X=void 0,Y=1,Z=2,$=0,_=function(){function a(a,b){this._instanceConstructor=a,this.promise=new a(l),this.promise[W]||B(this.promise),K(b)?(this.length=b.length,this._remaining=b.length,this._result=new Array(this.length),0===this.length?u(this.promise,this._result):(this.length=this.length||0,this._enumerate(b),0===this._remaining&&u(this.promise,this._result))):v(this.promise,C())}return a.prototype._enumerate=function(a){for(var b=this,c=0;this._state===X&&c<a.length;c++)b._eachEntry(a[c],c)},a.prototype._eachEntry=function(a,b){var c=this._instanceConstructor,d=c.resolve;if(d===k){var e=void 0,f=void 0,g=!1;try{e=a.then}catch(a){g=!0,f=a}if(e===j&&a._state!==X)this._settledAt(a._state,b,a._result);else if("function"!=typeof e)this._remaining--,this._result[b]=a;else if(c===aa){var h=new c(l);g?v(h,f):r(h,a,e),this._willSettleAt(h,b)}else this._willSettleAt(new c(function(b){return b(a)}),b)}else this._willSettleAt(d(a),b)},a.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===X&&(this._remaining--,a===Z?v(d,c):this._result[b]=c),0===this._remaining&&u(d,this._result)},a.prototype._willSettleAt=function(a,b){var c=this;w(a,void 0,function(a){return c._settledAt(Y,b,a)},function(a){return c._settledAt(Z,b,a)})},a}(),aa=function(){function a(b){this[W]=A(),this._result=this._state=void 0,this._subscribers=[],l!==b&&("function"!=typeof b&&G(),this instanceof a?z(this,b):H())}return a.prototype.catch=function(a){return this.then(null,a)},a.prototype.finally=function(a){var c=this,d=c.constructor;return b(a)?c.then(function(b){return d.resolve(a()).then(function(){return b})},function(b){return d.resolve(a()).then(function(){throw b})}):c.then(a,a)},a}();return aa.prototype.then=j,aa.all=D,aa.race=E,aa.resolve=k,aa.reject=F,aa._setScheduler=c,aa._setAsap=d,aa._asap=O,aa.polyfill=I,aa.Promise=aa,aa})}),k=Object.freeze({NAMESPACE:"local-slice",LOCATOR_LIMITED_COOKIE:"ckpf_locatorlimited",GEO_PROMPT_COOKIE:"ckpf_geoprompt",LOCATOR_API_KEY_FOR_TEST:"reKLjVDVrLNlTmHxcxY7adlgI3oN7ReG",LOCATOR_API_KEY_FOR_PROD:"oNToXjGi1v6FURXUkjmGA39nsB8HsxMv"}),l={LOCATION_COOKIE_CHANGED:"location_cookie_changed",AUTO_GEOLOCATION:"auto-geolocation:location",ISTATS_CHANGE_LOCATION:"istats:change_location",ISTATS_LOCSERV_DETECTED:"istats:locserv_detected",ISTATS_NO_COOKIE_DETECTED:"istats:no_cookie_detected",ISTATS_REGION_LINK_CLICKED:"istats:region_link_clicked",ISTATS_CONTENT_CLICKED:"istats:slice_content_clicked"},m=Object.keys(l).reduce(function(a,b){return a[b]=k.NAMESPACE+":"+l[b],a},{}),n=Object.freeze(m),o={FROM_COOKIE_NAV:"FROM_COOKIE_NAV",FROM_AUTO_GEO:"FROM_AUTO_GEO",FROM_USER_SEARCH:"FROM_USER_SEARCH"},p=/\/news\/local_news_slice/,q=function(a,b,c,d){this.namespace=a,this.locationData=c,this.ControllerFactory=b,this.Events=d,this.locServCookie=this.readCookie(),this.shouldFocusOnInput=null!==this.locServCookie,this.tempGeoCookie=this.locationData.returnLocatorLimiterCookie(),this.setEventEmitterHandlers(),this.container=document.querySelector(".js-local-news")};q.prototype.display=function(){var a=this;return this.locServCookie||this.tempGeoCookie?this.handleCookie():new j(function(b,c){if(a.displaySubheading(),a.createNewsController(),a.toggleColdStart(),"on"===a.container.getAttribute("data-auto-geolocation")&&a.canPromptGeo())return a.locationData.setGeoPromptCookie(),a.requestGeoLocation().then(function(c){a.Events.emit(n.AUTO_GEOLOCATION,c.results),b()}).catch(function(){a.Events.emit(n.ISTATS_NO_COOKIE_DETECTED),c()})})},q.prototype.init=function(){var a=this;return new j(function(b){a.locationData.getLocservCookieValue()&&"2"===a.locationData.getLocservCookieValue().charAt(0)?a.locationData.updateNewsCookie().then(function(){a.locServCookie=a.locationData.getNewsCookie(),a.display().then(function(){return b()})}):a.display().then(function(){b()}).catch(function(){b()})})},q.prototype.canPromptGeo=function(){return 1!==this.locationData.getGeoPromptCookie()},q.prototype.handleCookie=function(){if(this.locServCookie){var a=this.locServCookie.news;return this.loadSlice(a,o.FROM_COOKIE_NAV)}return this.loadSlice(this.tempGeoCookie.news,o.FROM_AUTO_GEO,this.tempGeoCookie)},q.prototype.setEventEmitterHandlers=function(){var a=this;this.Events.on(this.namespace+":component:search:clear",function(){a.showSliceStories()}),this.Events.on(this.namespace+":component:search:results",function(){a.hideSliceStories()}),this.Events.on(this.namespace+":component:auto_complete:render",function(){a.hideSliceStories()}),this.Events.on(this.namespace+":component:close_button:clicked",function(){a.toggleControllerVisibility(),a.showSliceStories()}),this.Events.on(this.namespace+":component:geolocation:location",function(b){a.handleLocationResult(b[0],o.FROM_AUTO_GEO)}),this.Events.on(n.AUTO_GEOLOCATION,function(b){a.handleLocationResult(b[0],o.FROM_AUTO_GEO)}),this.Events.on(this.namespace+":component:auto_complete:location",function(b){a.Events.emit(a.namespace+":component:search:clear"),a.chooseRegion(b[0])}),this.Events.on(this.namespace+":component:search_results:location",function(b){a.Events.emit(a.namespace+":component:search:clear"),a.chooseRegion(b[0])}),this.Events.on("error",function(b){a.setMessage(b[0].message)})},q.prototype.createEventHandlers=function(){var b=this;this.container.querySelector(".js-change-location").addEventListener("click",function(){b.Events.emit(n.ISTATS_CHANGE_LOCATION),b.createNewsController(),b.toggleControllerVisibility();var d=b.container.querySelector(".js-confirmation-box"),e=b.container.querySelector(".ls-ui-comp-close_button");c(d,"gs-u-display-block")&&a(e,"message-active"),b.container.querySelector('.ls-c-news__search-container input[type="text"]').focus()}),this.container.querySelector(".js-region").addEventListener("click",function(){b.Events.emit(n.ISTATS_REGION_LINK_CLICKED)}),this.container.querySelector(".js-stories").addEventListener("click",function(){b.Events.emit(n.ISTATS_CONTENT_CLICKED)})},q.prototype.readCookie=function(){return this.locationData.getNewsCookie()},q.prototype.requestGeoLocation=function(){return this.locationData.getGeolocation()},q.prototype.showCloseButton=function(){var a=this.container.querySelector(".ls-ui-comp-close_button");a&&c(a,"ls-u-hidden")&&(b(a,"ls-u-hidden"),a.setAttribute("aria-hidden",!1))},q.prototype.toggleColdStart=function(){var d=this.container.querySelector(".js-cold-start");d&&(c(d,"gs-u-display-inline-block")?(a(d,"gs-u-display-none"),b(d,"gs-u-display-inline-block")):(a(d,"gs-u-display-inline-block"),b(d,"gs-u-display-none"))),this.toggleControllerVisibility()},q.prototype.displaySubheading=function(){var a=this.container.querySelector(".js-subheading");a&&b(a,"gs-u-display-none")},q.prototype.hideChangeLocationButton=function(){var c=this.container.querySelector(".js-change-location");c&&(b(c,"gs-u-display-inline-block"),a(c,"gs-u-display-none"))},q.prototype.showChangeLocationButton=function(){var c=this.container.querySelector(".js-change-location");c&&(b(c,"gs-u-display-none"),a(c,"gs-u-display-inline-block"))},q.prototype.hideSliceStories=function(){var c=this.container.querySelector(".js-stories");c&&(b(c,"gs-u-display-block"),a(c,"gs-u-display-none"))},q.prototype.showSliceStories=function(){var c=this.container.querySelector(".js-stories");c&&(a(c,"gs-u-display-block"),b(c,"gs-u-display-none"))},q.prototype.createNewsController=function(){if(null===this.container.querySelector(".js-local-news .ls-c-news")){var a=this.container.querySelector(".js-location-controller");this.Events.clear(this.namespace+":component"),this.setEventEmitterHandlers(),this.ControllerFactory.create(this.namespace,a,this.shouldFocusOnInput)}},q.prototype.toggleControllerVisibility=function(){var d=this.container.querySelector(".js-location-controller"),e=this.container.querySelector(".js-cold-start");c(d,"gs-u-display-inline-block")?(this.showChangeLocationButton(),null===e&&(a(d,"gs-u-display-none"),b(d,"gs-u-display-inline-block"))):(this.hideChangeLocationButton(),a(d,"gs-u-display-inline-block"),b(d,"gs-u-display-none"))},q.prototype.showConfirmLocationChangeMessage=function(c,d){var e=this,f=this.container.querySelector(".js-confirmation-box"),g=this.container.querySelector(".js-confirm-location");a(f,"gs-u-display-inline-block"),a(g,"gs-u-display-block"),this.hideChangeLocationButton(),this.container.querySelector(".js-change-location-yes").addEventListener("click",function(){b(f,"gs-u-display-inline-block"),b(e.container.querySelector(".js-change-location"),"gs-u-display-none"),e.setNewsCookie(c,d[0])}),this.container.querySelector(".js-change-location-no").addEventListener("click",function(){b(f,"gs-u-display-inline-block"),e.createNewsController(),e.toggleControllerVisibility(),e.showCloseButton()})},q.prototype.showLocationChangedMessage=function(c){var d=this,e=this.container.querySelector(".js-confirmation-box"),f=this.container.querySelector(".js-location-confirmed"),g=this.container.querySelector(".js-chosen-region");a(e,"gs-u-display-block"),a(f,"gs-u-display-block"),g.innerHTML=c,this.showChangeLocationButton(),window.setTimeout(function(){var a=d.container.querySelector(".ls-ui-comp-close_button");b(e,"gs-u-display-block"),b(f,"gs-u-display-block"),b(a,"message-active")},1e4)},q.prototype.chooseRegion=function(a){var b=this;return this.locationData.requestLocationWithNewsDetails(a.id).then(function(c){b.hideSliceStories(),e(c,a,b.changeNewsRegion.bind(b)),b.showCloseButton()})},q.prototype.handleLocationResult=function(a,b){var c=this;return this.locationData.requestLocationWithNewsDetails(a.id).then(function(d){var e=c.locationData.getNewsDetails(d.details[0].externalId);c.canSetLimitLocatorCookie(b)&&c.locationData.setLocatorLimiterCookie(a,e),c.loadSlice(e,b,a)})},q.prototype.canSetLimitLocatorCookie=function(a){var b=a===o.FROM_AUTO_GEO;return"local.bbc.co.uk"===window.location.hostname||!!(b&&window.bbccookies&&window.bbccookies.isAllowed(k.LOCATOR_LIMITED_COOKIE))},q.prototype.changeNewsRegion=function(a,b){this.toggleColdStart(),this.Events.emit(this.namespace+":component:close_button:clicked");var c=this.locationData.getNewsDetails(b.externalId);this.setNewsCookie(a,c[0]),this.loadSlice(c,o.FROM_USER_SEARCH,a)},q.prototype.getSlice=function(a){var b=this;return new j(function(c,d){var e=5,f=function(a){var g=new XMLHttpRequest;g.open("GET",a+"?timeout="+(e+1)),g.onload=function(){if(b.invalidResponse(g))return void(e>=1?(e-=1,setTimeout(function(){return f(a)},2e3)):d({code:"response.error",message:"Maximum retries"}));g.status>=200&&g.status<400?c(b.resolveResponse(g)):d({code:g.status,message:"Sorry, we are experiencing technical problems."})},g.onerror=function(){d({code:"path.404",message:"Sorry, we are experiencing technical problems."})},g.send()};f(a)})},q.prototype.resolveResponse=function(a){return"text/html"===this.getContentType(a)?a.responseText:JSON.parse(a.responseText).bodyInline},q.prototype.getContentType=function(a){return a.getResponseHeader("Content-Type").split(";")[0]},q.prototype.invalidResponse=function(a){try{if(202===a.status||"text/html"===this.getContentType(a)&&500===a.status)return!0;if("text/html"===this.getContentType(a)&&200===a.status)return!1;if(200===a.status&&null===JSON.parse(a.responseText).bodyInline)return!0}catch(a){return!0}return!1},q.prototype.loadSlice=function(a,b,c){var d=this,e=this.fetchRegionName(b,c),f=a[0].name,g=this.makeNewsRegionLink(a),h=this.makeUri(a);return this.getSlice(h).then(function(h){var i=d.container.querySelector(".js-post-loaded");i.innerHTML=h,d.container.querySelector(".js-region").innerHTML=d.updateHeader(e,f,g),window.trackDataEntityIds&&window.trackDataEntityIds(i),d.determineResponseSuccess(b,e,c,a,g),b===o.FROM_COOKIE_NAV&&d.Events.emit(n.ISTATS_LOCSERV_DETECTED,a[0].name)}).catch(function(a){d.Events.emit("error",[{code:a.code,message:a.message}])})},q.prototype.isMozartPath=function(a){return null!==a.match(p)},q.prototype.fetchRegionName=function(a,b){var c=o.FROM_AUTO_GEO,d=o.FROM_USER_SEARCH;return a===c||a===d?b.name:this.locServCookie.name},q.prototype.determineResponseSuccess=function(a,b,c,d){this.displaySubheading(),this.container.querySelector(".js-stories-error")?(this.createNewsController(),this.toggleColdStart(),this.setMessage("Sorry, we are experiencing technical problems, please visit <a href="+this.makeNewsRegionLink(d)+">"+b+"</a> or search for another location.")):(this.determineConfirmationMessage(a,b,c,d),this.createEventHandlers())},q.prototype.setMessage=function(c){var d=this.container.querySelector(".ls-c-news__message-container");d.querySelector("p").innerHTML=c,a(d.querySelector("p"),"ls-c-message__content--active"),b(d,"gs-u-display-none")},q.prototype.determineConfirmationMessage=function(a,b,c,d){a===o.FROM_USER_SEARCH&&this.showLocationChangedMessage(b),a===o.FROM_AUTO_GEO&&this.showConfirmLocationChangeMessage(c,d),a===o.FROM_COOKIE_NAV&&this.showChangeLocationButton()},q.prototype.makeUri=function(a,b){var c=b||this.container.querySelector(".js-asset-path").getAttribute("data-slice-path"),d=this.makeEncodedNewsRegionLink(a);return c.match(p)?""+c+encodeURIComponent(d):c+"asset/"+d},q.prototype.makeNewsRegionLink=function(a){return"/news/"+a[0].path},q.prototype.makeEncodedNewsRegionLink=function(a){return encodeURIComponent("/news/"+a[0].path)},q.prototype.updateHeader=function(a,b,c){var d=a,e=filterXSS(c),f=filterXSS(a),g=filterXSS(b);return b!==a&&(d='<div aria-hidden="true" class="gs-u-display-inline-block gs-u-mr">'+f+'</div><div aria-label="'+f+" "+e+'" class="gs-u-display-inline-block">('+g+")</div>"),'<a class="nw-c-local__button--light" href='+e+">"+d+"</a>"},q.prototype.setNewsCookie=function(a,b){b.locServicesId&&isNaN(b.locServicesId)?this.locationData.setNewsCookie(a,b.id):this.locationData.setNewsCookie(a,b.locServicesId),this.Events.emit(n.LOCATION_COOKIE_CHANGED,[a,b])};var r=function(a,b){this.LOCATION_LABEL="location",this.LINK_LOCATION="local slice",this.moduleName={module_name:this.LOCATION_LABEL},this.Events=a,this.iStats=b,this.container=document.querySelector("js-local-news")};r.prototype.getLocationLabel=function(a){var b=a[0];return{module_name:this.LOCATION_LABEL,locationId:b.id,locationPlaceType:b.placeType||null,locationCountry:b.country||null,locationName:b.name+", "+b.container||null,link_location:this.LINK_LOCATION}},r.prototype.eventListeners=function(){var a=this;this.Events.on(n.ISTATS_CHANGE_LOCATION,function(){a.iStats&&a.iStats.log("click","news-local-slice-change-location",a.moduleName)}),this.Events.on(n.ISTATS_LOCSERV_DETECTED,function(b){a.iStats&&a.iStats.log("locserv-cookie-detected","news-local-slice-has-locserv-cookie",{has_locserv_cookie:!0,locserv_news_region:b||null,link_location:a.LINK_LOCATION})}),this.Events.on(n.AUTO_GEOLOCATION,function(b){var c=b?a.getLocationLabel(b):a.moduleName;a.iStats&&a.iStats.log("geolocation-detected","news-local-slice-auto-geolocation",c)}),this.Events.on(n.ISTATS_NO_COOKIE_DETECTED,function(){a.iStats&&a.iStats.log("no-cookie-detected","news-local-slice-cold-start")}),this.Events.on(n.ISTATS_REGION_LINK_CLICKED,function(){a.iStats&&a.iStats.log("region-link-clicked","news-local-slice-region-link-clicked")}),this.Events.on(n.ISTATS_CONTENT_CLICKED,function(){a.iStats&&a.iStats.log("slice-content-clicked","news-local-slice-news-content-clicked")})};var s=window.Morph||{},t=void 0===s.config?"test":s.config.pushEnv,u="live"===t?k.LOCATOR_API_KEY_FOR_PROD:k.LOCATOR_API_KEY_FOR_TEST,v={api_key:u,stack:"aws",env:t,protocol:"https",filter:"domestic",order:"importance","place-types":["settlement","airport","district"],op:"intersect"},w=function(a,b,c){this.NewsController=a,this.En=new b,this.iStats=c};w.prototype.create=function(a,b,c){return new this.NewsController({apiConfig:v,namespace:a,container:b,translations:this.En,placeTypes:["settlement","airport","district"],smallGeo:!0,alwaysOpen:!1,autoComplete:!0,stats:this.iStats,focusOnInput:c})};var x=k.LOCATOR_LIMITED_COOKIE,y=k.GEO_PROMPT_COOKIE,z=function(a,b,c,d){this.API=a,this.geolocation=b,this.preferredLocation=c,this.news=d};z.prototype.getGeolocation=function(){var a=this;return new j(function(b,c){a.geolocation.getCurrentPosition(function(d){var e=d.coords.latitude,f=d.coords.longitude;a.API.reverseGeocode(e,f,{success:function(a){b(a)},error:function(a){c(a)}})},function(a){c(a)})})},z.prototype.requestLocationWithNewsDetails=function(a){var b=this;return new j(function(c,d){b.API.getLocation(a,{detailTypes:["news"],placeTypes:["road","settlement","airport","district"],success:function(a){c(a)},error:function(a){d(a)}})})},z.prototype.getNewsCookie=function(){return this.preferredLocation.getLocServCookieLocation()},z.prototype.setLocatorLimiterCookie=function(a,b){var c=encodeURI(a.name),d=encodeURI(a.id),e=encodeURI(b[0].locServicesId),f=new Date;f.setTime(f.getTime()+18e5);var g=f.toUTCString();document.cookie=x+"=1:locationId="+d+":locationName="+c+":newsRegionId="+e+";expires="+g+";"},z.prototype.getLocatorLimiterCookie=function(){var a=document.cookie.match(new RegExp(x+"=(.*?)(;|$)"));return!a||a.length<2?null:a[1]},z.prototype.setGeoPromptCookie=function(){var a=new Date;a.setFullYear(a.getFullYear()+1);var b=a.toUTCString();("local.bbc.co.uk"===window.location.hostname||window.bbccookies&&window.bbccookies.isAllowed(y))&&(document.cookie=y+"=1;expires="+b+";")},z.prototype.getGeoPromptCookie=function(){var a=document.cookie.match(new RegExp(y+"=(.*?)(;|$)"));return!!a&&parseInt(a[1],10)},z.prototype.convertCookieToObject=function(a){if(null===a)return!1;try{var b=a.split(":"),c=b[1].split("=")[1],d=b[2].split("=")[1],e=b[3].split("=")[1],f=this.getNewsDetails(e);return this.makeCookieObject(c,d,e,f)}catch(a){return!1}},z.prototype.makeCookieObject=function(a,b,c,d){var e=d[0].name,f=d[0].path;return{id:decodeURI(a),name:decodeURI(b),news:[{id:decodeURI(c),locServicesId:decodeURI(c),name:decodeURI(e),path:decodeURI(f)}]}},z.prototype.returnLocatorLimiterCookie=function(){var a=this.getLocatorLimiterCookie();return this.convertCookieToObject(a)},z.prototype.setNewsCookie=function(a,b){this.preferredLocation.setLocServCookieLocation(a,{newsRegionId:b})},z.prototype.getNewsDetails=function(a){return this.news.get(a)},z.prototype.getLocservCookieValue=function(){return this.preferredLocation.getLocServCookie()},z.prototype.updateNewsCookie=function(){var a=this;return new j(function(b,c){var d=a.getNewsCookie();a.requestLocationWithNewsDetails(d.id).then(function(c){var d=c.details[0].externalId;a.setNewsCookie(c.location,d),b()}).catch(function(a){c(a)})})},window.document.addEventListener("DOMContentLoaded",h)}();